<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>位数定理 | SNNN数論</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/SNNN-number-theory/favicon.ico"><meta name="description" content="3,37,377,3777,…の性質を探る数学"><meta name="keywords" content="SNNN数,クッキー☆,数学,整数論,数論,数学ッキー☆,SNNN姉貴,理系淫夢"><meta property="og:url" content="https://kumrnm.github.io/SNNN-number-theory/"><meta property="og:title" content="位数定理 | SNNN数論"><meta property="og:description" content="3,37,377,3777,…の性質を探る数学"><meta property="og:image" content="https://kumrnm.github.io/SNNN-number-theory/images/card.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="位数定理 | SNNN数論"><meta name="twitter:description" content="3,37,377,3777,…の性質を探る数学"><meta name="twitter:image" content="https://kumrnm.github.io/SNNN-number-theory/images/card.jpg"><meta name="twitter:creator" content="@kumrnm"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- KaTeX --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous"><script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script><script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script><script src="/SNNN-number-theory/js/common.js"></script><script src="/SNNN-number-theory/js/openclose.js"></script><script src="/SNNN-number-theory/js/fixmenu_pagetop.js"></script><link rel="stylesheet" href="/SNNN-number-theory/css/style.css"></head><body><div id="container"><header><!-- <h1 id="logo"><a href="/index.html"><img src="/images/logo.png" alt="SNNN数論"></a></h1> --><!--スライドショー--><aside id="mainimg"><img src="/SNNN-number-theory/images/banner.jpg" alt="SNNN数論" class="slide0"></aside><a id="titleLink" href="/SNNN-number-theory/"></a></header><div id="contents"><div id="main"><h2>位数定理</h2><p class="date">更新日：2022/9/30</p><p class="pb-more"><a href="prime_power_1">前回の記事</a>で，一般化SNNN数列 $S_{a,b,s}$ の項が素数 $p$ で何回割り切れるかという問題を，$a$ の素因数に限って考察した．それでは，$a$ と互いに素な素数 $p$ についてはどうなるだろうか．<a href="period.html#theorem_cycle">巡回定理</a>において，$S_{a,b,s}$ が $p$ で割り切れる周期は位数 $\ord_p(a)$ を用いて記述された．このことから，$p^k$（$k$ は正整数）で割り切れる周期に関して $\ord_{p^k}(a)$ が重要な役割を果たすことは容易に予想されよう．本記事では，素数の累乗を法とする位数に関する重要な定理である<strong>位数定理</strong>の証明を行う．</p><h3 id="order">位数</h3><p>位数の定義は巡回定理の記事で紹介したが，ここで改めて述べておこう．</p><p class="definition pb-less" id="definition_order"><span>定義</span> 整数 $m$ と，$m$ と互いに素な整数 $a$ に対して，合同方程式 $a^x\equiv 1\mod{m}$ の最小の正の解 $x$ を，法 $m$ における $a$ の<a href="https://manabitimes.jp/math/905"><strong>位数</strong></a>といい，$\ord_m(a)$ で表す．</p><h5 class="example" id="example_order">例</h5><p class="pb-more">法 $13$ における $10$ の位数を求める．$x=1,2,3,\cdots$ に対して $10^x$ を $13$ で割った余りを計算すると $$ \begin{align*} 10^1 &\equiv 10 &\mod{13} \\ 10^2 &\equiv 9 &\mod{13} \\ 10^3 &\equiv 12 &\mod{13} \\ 10^4 &\equiv 3 &\mod{13} \\ 10^5 &\equiv 4 &\mod{13} \\ 10^6 &\equiv 1 &\mod{13} \\ \end{align*} $$ となる．よって $\ord_{13}(10)=6$ である．</p><h3 id="W">ヴィーフェリッヒ階数</h3><p>この節では，位数定理の記述に必要な概念である<strong>ヴィーフェリッヒ階数</strong>を導入する．</p><p class="definition pb-less" id="definition_W"><span>定義</span> 整数 $a$ を底とする素数 $p$ の<strong>ヴィーフェリッヒ階数</strong> $W_p(a)$ を $$ W_p(a) \coloneqq \nu_p(a^{p-1}-1) $$ で定める（$\nu_p$ の定義は<a href="prime_power_1.html#definition_nu">こちら</a>）．</p><h5 class="example" id="example_W">例</h5><p class="pb-more">$W_3(10)=2,$ $W_7(10)=1,$ $W_{11}(10)=1,$ $W_{13}(10)=1,$ $W_{17}(10)=1,$ $W_{19}(10)=1$.</p><p class="pb-more">$a$ が $p$ と互いに素であれば，<a href="https://ja.wikipedia.org/wiki/%E3%83%95%E3%82%A7%E3%83%AB%E3%83%9E%E3%83%BC%E3%81%AE%E5%B0%8F%E5%AE%9A%E7%90%86">フェルマーの小定理</a> $a^{p-1}\equiv 1\mod{p}$ より $W_p(a)\ge 1$ である．実は，ほとんどの $a,p$ に対して $W_p(a)=1$ であり，$W_p(a)>1$ となるような場合は極めて稀である．例えば，底 $a$ が $10$ であるとき，$W_p(10)>1$ となるような $p$ は $3,$ $487,$ $56598313$ の3つのみが知られている．このような $p$ を，$a$ を底とする<a href="https://en.wikipedia.org/wiki/Wieferich_prime#Base-a_Wieferich_primes"><strong>ヴィーフェリッヒ素数</strong></a>という．</p><h3 id="order_theorem">位数定理</h3><p class="theorem pb-less" id="theorem"><span>位数定理</span> $p$ を<strong>奇素数</strong>，$k$ を正整数, $a$ を $p$ と互いに素な整数とする．このとき， $$ \ord_{p^k}(a) = p^{\max(0, k-W_p(a))} \cdot \ord_p(a). $$</p><h5 class="example" id="example">例</h5><p>$\ord_{3}(10)=1, W_3(10)=2$ より $\ord_{3^2}(10) = 3^0 \cdot 1 = 1,$ $\ord_{3^3}(10) = 3^1 \cdot 1 = 3,$ $\ord_{3^4}(10) = 3^2 \cdot 1 = 9,$ $\ord_{3^5}(10) = 3^3 \cdot 1 = 27$.</p><p class="attention pb-more"><span>注意</span> この定理は <strong>$p=2$ では成立しない</strong>．$p=2$ の取り扱いについては<a href="p2.html">こちらの記事</a>を参照されたい．</p><p>以下，この定理の証明を行う．本サイトでは基本的に高校数学以外の前提知識を仮定しない方針をとっているが，この証明では例外的に群論の基礎知識を前提として議論を進める．難解であれば読み飛ばしても差し支えない．</p><p class="pb-less">まず，次の記法を約束する．</p><ul class="disc pb-less"><li>$\Z/m\Z$ や $(\Z/m\Z)^\times$ の元について，$n\in\Z$ の合同類は本来 $[n]$ や $\bar{n}$ などと表記すべきであるが，これを省略して単に $n$ と表記する．</li><li>一般の群 $G$ における $x\in G$ の位数を $\ord_G(x)$ と表記する．すなわち $\ord_m(n)=\ord_{(\Z/m\Z)^\times}(n)$.</li></ul><p>さて，議論の出発点として次の群同型を考える（証明は<a href="https://integers.hatenablog.com/entry/2016/07/24/163831">こちら</a>を参照）． $$ \begin{align*} (\Z/p^k\Z)^\times &\simeq \Z/p^{k-1}(p-1)\Z \\ &\simeq \Z/p^{k-1}\Z \times \Z/(p-1)\Z \end{align*} $$ 法 $p^k$ の<a href="https://ja.wikibooks.org/wiki/%E5%88%9D%E7%AD%89%E6%95%B4%E6%95%B0%E8%AB%96/%E5%8E%9F%E5%A7%8B%E6%A0%B9%E3%81%A8%E6%8C%87%E6%95%B0">原始根</a>を $g$ とおくと，1行目の同型は $g$ の指数関数であり，2行目の同型は自然な写像である．$p^{k-1}$ と $p-1$ は互いに素であるから，$a$ が $a\equiv g^{a'} \mod{p^k}$ と表示されるとき $$ \begin{align} \ord_{p^k}(a) = \ord_{\Z/p^{k-1}\Z}(a') \cdot \ord_{\Z/(p-1)\Z}(a') \end{align} $$ が成り立つ．</p><p>この式を用いて，$k$ が変化したときの $\ord_{p^k}(a)$ の変化を考えよう．いま，十分大きな正整数 $K$ をとり，法 $p^K$ の原始根 $g$ を用いて $a\equiv g^{a'}\mod{p^K}$ と表示する．ここで $k$ が $1\le k\le K$ の範囲を動くとき，$g$ は法 $p^k$ の原始根であり，$a$ の表示 $a\equiv g^{a'}\mod{p^k}$ が成立する（$g$ および $a'$ が $k$ に依存しないことに注意せよ）．よって，(1)式において $k=1$ とすれば $$ \begin{align*} \ord_{p^1}(a) &= \ord_{\Z/\Z}(a') \cdot \ord_{\Z/(p-1)\Z}(a') \\ \ord_{p}(a) &= 1 \cdot \ord_{\Z/(p-1)\Z}(a') \\ \end{align*} $$ を得る．これを再び(1)式に代入すると $$ \begin{align} \ord_{p^k}(a) = \ord_{\Z/p^{k-1}\Z}(a') \cdot \ord_p(a) \end{align} $$ となる．</p><p>ここで次の補題を用いる．</p><p class="theorem pb-less" id="lemma"><span>補題</span> $p$ を素数, $k$ を自然数，$n$ を整数とする．このとき， $$ \ord_{\Z/p^k\Z}(n) = p^{\max(0, k-\nu_p(n))}. $$</p><h5 class="proof">証明</h5><p class="pb-more">$\ord_{\Z/p^k\Z}(n)$ は，$nx\equiv0 \mod{p^k}$ を満たす最小の正整数 $x$ である．ここで $$ \begin{align*} & nx\equiv 0 \mod{p^k} \\ \iff& \nu_p(nx) \ge k \\ \iff& \nu_p(n) + \nu_p(x) \ge k \\ \iff& \nu_p(x) \ge k - \nu_p(n) \\ \iff& x \equiv 0 \mod{p^{\max(0,k-\nu_p(n))}} \\ \end{align*} $$ であるから補題が成立する．$\blacksquare$</p><p>この補題を(2)式に適用すると $$ \begin{align} \ord_{p^k}(a) = p^{\max(0,k-1-\nu_p(a'))} \cdot \ord_p(a) \end{align} $$ となる．この式より $$ \begin{align*} \ord_{p^k}(a)=\ord_p(a) &\iff p^{\max(0,k-1-\nu_p(a'))}=1 \\ &\iff k-1-\nu_p(a')\le 0 \\ &\iff k \le 1+\nu_p(a') \end{align*} $$ が導かれる．一方，位数の定義より $$ \begin{align*} \ord_{p^k}(a)=\ord_p(a) &\iff a^{\ord_p(a)}\equiv 1 \mod{p^k} \\ &\iff \nu_p(a^{\ord_p(a)}-1) \ge k \end{align*} $$ であるから，2つの条件を比較して $$ \begin{align} 1+\nu_p(a') = \nu_p(a^{\ord_p(a)}-1) \end{align} $$ を得る．ここで，$\ord_p(a)$ は $p-1$ の約数であるから $$ a^{p-1}-1 = (a^{\ord_p(a)}-1) \left(a^0 + a^{\ord_p(a)} + a^{2\cdot\ord_p(a)} + \cdots + a^{\left( \frac{p-1}{\ord_p(a)}-1 \right)\cdot\ord_p(a)} \right) $$ が成り立つ．右辺の和を $p$ で割った余りを考えると $$ \begin{align*} & \quad\; a^0 + a^{\ord_p(a)} + a^{2\cdot\ord_p(a)} + \cdots + a^{\left( \frac{p-1}{\ord_p(a)}-1 \right)\cdot\ord_p(a)} \\ &\equiv 1+1+1+\cdots+1 \\ &\equiv \frac{p-1}{\ord_p(a)} \nequiv 0 \qquad\quad\mod{p} \end{align*} $$ であるから， $$ \nu_p(a^{\ord_p(a)}-1) = \nu_p(a^{p-1}-1) = W_p(a) $$ を得る．これと(4)式より $1+\nu_p(a')=W_p(a)$ であるから，これを(3)式に代入して $$ \ord_{p^k}(a) = p^{\max(0, k-W_p(a))} \cdot \ord_p(a) $$ となる．以上で位数定理が示された．</p><div class="footer-links"><div><a href="prime_power_1.html">前の記事へ</a></div><div><a href="../contents.html#theory">目次に戻る</a></div><div><a href="prime_power_2.html">次の記事へ</a></div></div></div><!--/#main--><div id="sub"><!--PC用（801px以上端末）メニュー--><nav id="menubar"><h2>Menu</h2><ul><li><a href="/SNNN-number-theory/">HOME</a></li><li><a href="/SNNN-number-theory/contents.html">CONTENTS</a></li><li><a href="/SNNN-number-theory/link.html">LINK</a></li></ul></nav><div class="side-profile"><div class="side-profile-header">著者</div><div class="side-profile-container"><div class="side-profile-left"><img src="/SNNN-number-theory/images/kumrnm.jpg" alt="蝙蝠の目"></div><div class="side-profile-right"><div class="side-profile-name">蝙蝠の目</div><div class="side-profile-links"><a href="https://www.nicovideo.jp/user/119196563" target="_blank">niconico</a></div></div></div></div></div><!--/#sub--></div><!--/#contents--></div><!--/#container--><footer><small>Copyright&copy; 2022 蝙蝠の目 All Rights Reserved.</small> <span class="pr"><a href="http://template-party.com/" target="_blank">《Web Design:Template-Party》</a></span></footer><!--小さな端末用（800px以下端末）メニュー--><nav id="menubar-s"><ul><li><a href="/SNNN-number-theory/">HOME</a></li><li><a href="/SNNN-number-theory/contents.html">CONTENTS</a></li><li><a href="/SNNN-number-theory/link.html">LINK</a></li></ul></nav><!--ページの上部に戻る「↑」ボタン--><p class="nav-fix-pos-pagetop"><a href="#">↑</a></p><!--メニュー開閉ボタン--><div id="menubar_hdr" class="close"></div><!--メニューの開閉処理条件設定　800px以下--><script>if (OCwindowWidth() <= 800) {
	open_close("menubar_hdr", "menubar-s");
}</script></body></html>