<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>SNNN素因数定理 | SNNN数論</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/SNNN-number-theory/favicon.ico"><meta name="description" content="3,37,377,3777,…の性質を探る数学"><meta name="keywords" content="SNNN数,クッキー☆,数学,整数論,数論,数学ッキー☆,SNNN姉貴,理系淫夢"><meta property="og:url" content="https://kumrnm.github.io/SNNN-number-theory/"><meta property="og:title" content="SNNN素因数定理 | SNNN数論"><meta property="og:description" content="3,37,377,3777,…の性質を探る数学"><meta property="og:image" content="https://kumrnm.github.io/SNNN-number-theory/images/card.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="SNNN素因数定理 | SNNN数論"><meta name="twitter:description" content="3,37,377,3777,…の性質を探る数学"><meta name="twitter:image" content="https://kumrnm.github.io/SNNN-number-theory/images/card.jpg"><meta name="twitter:creator" content="@kumrnm"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- KaTeX --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous"><script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script><script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script><script src="/SNNN-number-theory/js/common.js"></script><script src="/SNNN-number-theory/js/openclose.js"></script><script src="/SNNN-number-theory/js/fixmenu_pagetop.js"></script><link rel="stylesheet" href="/SNNN-number-theory/css/style.css"></head><body><div id="container"><header><!-- <h1 id="logo"><a href="/index.html"><img src="/images/logo.png" alt="SNNN数論"></a></h1> --><!--スライドショー--><aside id="mainimg"><img src="/SNNN-number-theory/images/banner.jpg" alt="SNNN数論" class="slide0"></aside><a id="titleLink" href="/SNNN-number-theory/"></a></header><div id="contents"><div id="main"><h2>SNNN素因数定理</h2><p class="date">更新日：2022/9/30</p><p><a href="prime_factors.html#theorem">以前の記事</a>で，SNNN数列 $S_{10,7,3}$ が無数の素因数を含むことを証明した．この事実を一般化したものが，本記事で示す<strong>SNNN素因数定理</strong>である．この定理の証明はSNNN数論における一つの山場であり，これまでに証明した数々の定理を総動員するものである．本記事の内容を理解できれば，SNNN数論の中級者は卒業と言ってよいだろう．</p><p class="theorem pb-more" id="theorem"><span>SNNN素因数定理</span> 一般化SNNN数列 $S_{a,b,s}$ が $|a|>1,b\neq 0,D\neq 0$ を満たすならば，$S_{a,b,s}$ は無数の素因数を含む．</p><h3 id="log_sum">SNNN対数和</h3>まず，SNNN素因数定理の証明において重要な役割を担う<strong>SNNN対数和</strong>を導入する．<p class="definition pb-less" id="definition_log_sum"><span>定義</span> 全ての項が正であるような一般化SNNN数列 $S$ に対し，<strong>SNNN対数和</strong> $\psi$ を $$ \psi(n) \coloneqq \sum_{i=0}^{n-1}\log{S(i)} $$ で定める．ただし，$\log$ は自然対数（底は $e$）．</p><h5 class="example" id="example_log_sum">例</h5><p class="pb-more">SNNN数列 $S_{10,7,3}$ に対するSNNN対数和 $\psi$ を考えると $$ \begin{align*} \psi(0) &= 0 \\ \psi(1) &= \log{3} \\ \psi(2) &= \log{3} + \log{37} \\ \psi(3) &= \log{3} + \log{37} + \log{377}. \\ \end{align*} $$</p><p>SNNN対数和と素因数の関連性を見ておこう．まず，対数の基本性質として，次のような性質があった． $$ \log{377} = \log(13\cdot 29) = \log{13} + \log{29} $$ この式は次のようにも表される． $$ \log{377} = \nu_{13}(377) \cdot \log{13} + \nu_{29}(377) \cdot \log{29} $$ この式に，$377$ の素因数でない素数 $p$（すなわち $\nu_p(377)=0$ であるような $p$）を付け加えることも可能だろう． $$ \log{377} = \nu_{3}(377) \cdot \log{3} + \nu_{13}(377) \cdot \log{13} + \nu_{29}(377) \cdot \log{29} $$ 一般に，一般化SNNN数列 $S$ に現れる素因数の集合を $P_S$ とおけば $$ \log{S(i)} = \sum_{p\in P_S}\nu_p(S(i))\cdot \log{p} $$ であるから，SNNN対数和は $$ \begin{align*} \psi(n) &= \sum_{i=0}^{n-1}\sum_{p\in P_S}\nu_p(S(i))\cdot \log{p} \\ &= \sum_{p\in P_S} (\log{p}) \sum_{i=0}^{n-1} \nu_p(S(i)) \\ \end{align*} $$ と表される．ここで $$ \bar\psi_p(n) \coloneqq \sum_{i=0}^{n-1} \nu_p(S(i)) $$ とおけば $$ \begin{align} \psi(n) = \sum_{p\in P_S} \bar\psi_p(n)\cdot\log{p} \end{align} $$ が成り立つ．</p><p class="point pb-more"><span>ポイント</span> SNNN対数和は，「一般化SNNN数列にわたる和」であると同時に「素因数にわたる和」でもある．</p><h3 id="partial_sequence">「都合の良い部分列」の選定</h3><p>さて，以下ではSNNN対数和を用いてSNNN素因数定理の証明を行うのだが，与えられた一般化SNNN数列 $S=S_{a,b,s}$ の全ての項が正である保証はないため，そのままSNNN対数和を考えることはできない．そこで，$S$ の中から「都合の良い部分列」を取り出し，その中に素因数が無数に含まれていることを証明する方針をとる．</p><p>まず，$a\lt -1$ である場合を考える．このとき $S$ は「初項 $s$ に関数 $f(x)=ax+b$ を繰り返し適用した数列」である．ここで「初項 $s$ に関数 $f^2(x)=a^2x+(a+1)b$ を繰り返し適用した数列」$S'$ を考えると，$S'$ は一般化SNNN数列 $S_{a^2,(a+1)b,s}$ であり，なおかつ $S$ の部分列である．したがって，この $S'$ を新たに $S=S_{a,b,s}$ とおけば，<strong>一般性を失わずに $a\gt 1$ を仮定する</strong>ことができる．</p><p>いま，$a\gt 1$ であり，さらに定理の仮定より $D\neq 0$ であるから，$S$ は単調増加または単調減少のいずれかである（<a href="definition.html#exercise_D">初回の演習問題</a>を参照）．単調減少である場合には，全ての項を $-1$ 倍した一般化SNNN数列 $S_{a,-b,-s}$ を新たに $S=S_{a,b,s}$ とおくことで，<strong>一般性を失わずに $S$ が単調増加である（すなわち $D\gt 0$）と仮定する</strong>（これは元の数列の部分列ではないが，明らかに素因数の集合を保存している）．このとき，十分大きな自然数 $N$ をとれば，$S(N)$ 以降の項が全て正となる．この部分 $S_{a,b,S(N)}$ を新たに $S=S_{a,b,s}$ とおくことで，<strong>一般性を失わずに $S$ の全ての項が正であると仮定する</strong>．</p><p class="pb-more">なお，以上の一連の変換において，定理の仮定 $b\neq 0$ が保存されていることに注意しよう．</p><h3 id="psi">$\psi$ の下界</h3><p class="pb-more">仮定 $a\gt 1$ と $s=S(0)\gt 0$ より $D=(a-1)s+b\gt b$ である．このことに注意し，<a href="definition.html#theorem_expression">一般化SNNN数列の一般項</a>を用いて $S$ のSNNN対数和 $\psi$ を計算すると $$ \begin{align*} \psi(n) &= \sum_{i=0}^{n-1} \log{S(i)} \\ &= \sum_{i=0}^{n-1} \log\frac{Da^i-b}{a-1} \\ &= \sum_{i=0}^{n-1} \log\frac{Da^i}{a-1}\left(1-\frac{b}{Da^i}\right) \\ &= \sum_{i=0}^{n-1} \left\{ i\log a + \log\frac{D}{a-1} + \log\left(1-\frac{b}{Da^i}\right) \right\} \\ &= \frac{\log a}{2}n(n-1) + n\log\frac{D}{a-1} + \sum_{i=0}^{n-1}\log\left(1-\frac{b}{Da^i}\right) \\ &= \frac{\log a}{2}n^2 + \left(\log\frac{D}{\sqrt{a}(a-1)}\right)n + \sum_{i=0}^{n-1}\log\left(1-\frac{b}{Da^i}\right) \\ \end{align*} $$ となる．ここで不等式 $\log x\ge 1-\frac{1}{x}$ を用いると $$ \begin{align*} \sum_{i=0}^{n-1}\log\left(1-\frac{b}{Da^i}\right) &\ge \sum_{i=0}^{n-1}\left(1-\frac{Da^i}{Da^i-b}\right) \\ &= \sum_{i=0}^{n-1} \frac{-b}{Da^i-b} \\ &\ge -\frac{b}{Da^0-b} + \sum_{i=1}^{n-1} \frac{-\lvert b \rvert}{Da^i-Da^{i-1}} \\ &= -\frac{b}{D-b} - \frac{\lvert b\rvert}{D(a-1)}\sum_{i=1}^{n-1}\frac{1}{a^{i-1}} \\ &&gt; -\frac{b}{D-b} - \frac{\lvert b\rvert}{D(a-1)}\sum_{i=1}^{\infty}\frac{1}{a^{i-1}} \\ &= -\frac{b}{D-b} - \frac{\lvert b\rvert}{D(a-1)}\frac{1}{1-a^{-1}} \\ &= -\frac{b}{D-b} - \frac{a\lvert b\rvert}{D(a-1)^2} \end{align*} $$ であるから $$ \begin{align} \psi(n) \gt \frac{\log a}{2}n^2 + \left(\log\frac{D}{\sqrt{a}(a-1)}\right)n - \frac{b}{D-b} - \frac{a\lvert b\rvert}{D(a-1)^2} \end{align} $$ を得る．とくに，右辺が $n$ の二次関数であることに着目しよう．</p><h3 id="psi_p">$\bar\psi_p$ の上界</h3><p class="pb-less">続いて $\bar\psi_p(n)=\sum_{i=0}^{n-1} \nu_p(S(i))$ の上界を求めよう．$p$ が $a$ の素因数であるか否かで場合分けを行う．</p><h4>$p \mid a$ の場合</h4><p class="pb-less">仮定 $b\neq 0$ より，$\nu_p(S(n))$ は有界である（<a href="prime_power_1.html#theorem">証明</a>）．よってその上限を $M_p$ とおけば $$ \begin{align} \bar\psi_p(n) = \sum_{i=0}^{n-1} \nu_p(S(i)) \le \sum_{i=0}^{n-1} M_p = M_pn \end{align} $$ が成り立つ．</p><h4>$p \nmid a$ の場合</h4><p>$\bar\psi_p(n)$ について，実は次の関係式が成り立っている． $$ \begin{align*} \bar\psi_p(n) &= (\text{$S(0)$ から $S(n-1)$ までの $p$ の倍数の個数}) \\ &\,+ (\text{$S(0)$ から $S(n-1)$ までの $p^2$ の倍数の個数}) \\ &\,+ (\text{$S(0)$ から $S(n-1)$ までの $p^3$ の倍数の個数}) \\ &\,+ \cdots \\ \end{align*} $$ このことは，右辺の和において $p$ の倍数は1回，$p^2$ の倍数は（$p$ の倍数でもあるから）2回，$\cdots$ 数えられていることから理解される．</p><p>それでは，「$S(0)$ から $S(n-1)$ までの $p^k$ の倍数の個数」はどのように数えられるだろうか．我々は既に，<a href="prime_power_2.html#theorem">素数冪の巡回定理</a>および<a href="p2.html#theorem">素数冪の巡回定理 (p=2)</a>において，一般化SNNN数列 $S$ が $p^k$ を法とする基本周期 $$ \begin{align} u_{p^k}=\begin{cases} 1 & \text{if }k\le \nu_p(D)-\nu_p(a-1)+\nu_2(p) \\ p^{\max(0,k-\~k_p)}\cdot\ord_{p^{1+\nu_2(p)}}(a) & \text{otherwise} \\ \end{cases} \end{align} $$ を持つことを明らかにした（$\nu_2(p)$ を用いて一つの式にまとめている）．また，<a href="period.html#theorem_period">基本周期の性質</a>は，$S$ 上の連続した $u_{p^k}$ 項に $p^k$ の倍数は高々1個しか存在しないことを主張する．このことから，<strong>$S(0)$ から $S(n-1)$ までの連続した $n$ 項には $p^k$ の倍数が高々 $\lceil\frac{n}{u_{p^k}}\rceil$ 個しか存在しない</strong>ことが導かれる．ゆえに $$ \bar\psi_p(n) \le \sum_{k=1}^{\infty} \lceil\frac{n}{u_{p^k}}\rceil $$ と表せるが，この式は右辺の無限和が発散してしまい，使い物にならない．そこで，右辺の和を有限個で打ち切ることを考える．いま，$S$ は単調増加であるから，$S(0)$ から $S(n-1)$ までの全ての項は $S(n)$ 未満である．したがって，$p^k\ge S(n)$ すなわち $k\ge \log_p{S(n)}$ を満たすような $k$ については，$p^k$ の倍数が $S(n)$ より前に存在することはない．よって $$ \bar\psi_p(n) \le \sum_{k=1}^{\lfloor\log_p{S(n)}\rfloor} \lceil\frac{n}{u_{p^k}}\rceil $$ が成立する．</p><p class="pb-more">さて，この式の上界を与えるためには，$u_{p^k}$ の下界を調べればよい．(4)式において，常に $\nu_p(D)-\nu_p(a-1)+\nu_2(p)\le\~k_p$ であることに注意すれば $$ u_{p^k} \ge p^{k-\~k_p} $$ が得られる．したがって $$ \begin{align*} \bar\psi_p(n) &\le \sum_{k=1}^{\lfloor\log_p{S(n)}\rfloor} \lceil\frac{n}{u_{p^k}}\rceil \\ &\le \sum_{k=1}^{\lfloor\log_p{S(n)}\rfloor} \left(\frac{n}{u_{p^k}}+1\right) \\ &= \lfloor\log_p{S(n)}\rfloor + \sum_{k=1}^{\lfloor\log_p{S(n)}\rfloor} \frac{n}{u_{p^k}} \\ &\le \log_p{S(n)} + n\sum_{k=1}^{\lfloor\log_p{S(n)}\rfloor} \frac{1}{p^{k-\~k_p}} \\ &\lt \log_p{S(n)} + n\sum_{k=1}^\infty \frac{p^{\~k_p}}{p^k} \\ &= \log_p{S(n)} + \frac{p^{\~k_p}}{p-1}n \\ \end{align*} $$ が成り立つ．ここで $$ \begin{align*} \log_p{S(n)} &= \log_p\frac{Da^n-b}{a-1} \\ &\le \log_p\frac{Da^n+|b|}{a-1} \\ &\le \log_p\frac{Da^n+|b|a^n}{a-1} \\ &= \log_p\frac{D+|b|}{a-1}a^n \\ &= \log_p\frac{D+|b|}{a-1}+n\log_p{a} \\ \end{align*} $$ であるから $$ \begin{align} \bar\psi_p(n) \lt \left( \log_p{a}+\frac{p^{\~k_p}}{p-1} \right)n + \log_p\frac{D+|b|}{a-1} \end{align} $$ を得る．</p><p class="pb-more">(3),(5)式より，いずれの場合も <strong>$\bar\psi_p(n)$ は $n$ の一次関数で抑えられる</strong>ことが分かる．</p><h3 id="RAA">証明の完結</h3><p>ここで背理法を用いる．すなわち，$S$ に現れる素因数の集合 $P_S$ が有限集合であると仮定する．このとき(1)式に着目すると，$\psi(n)$ は $\bar\psi_p(n)$ の有限線形和である．$\bar\psi_p(n)$ が $n$ の一次関数で抑えられることから，<strong>それらの有限線形和である $\psi(n)$ もまた $n$ の一次関数で抑えられる</strong>はずである． $$ \psi(n) \le An+B $$ したがって特に $$ \lim_{n\to\infty}\frac{\psi(n)}{n^2} \le \lim_{n\to\infty}\frac{An+B}{n^2} =0 $$ である．一方，(2)式から $$ \lim_{n\to\infty}\frac{\psi(n)}{n^2}\ge \frac{\log{a}}{2} $$ が導かれ，矛盾が生じる．よって $P_S$ は無限集合である．</p><h5 class="exercise" id="exercise">演習問題</h5><p class="pb-less">一般化SNNN数列 $S_{1,b,s}$ （ただし $b\neq 0$ とする）は等差数列である．この数列はSNNN素因数定理の前提条件 $|a|>1$ を満たさないが，実は素因数を無数に含むことが知られている．このことを示そう．</p><ol class="parentheses"><li>一般化SNNN数列 $S_{2,b',s'}$ が $S_{1,b,s}$ の部分列となるような $(b',s')$ を1つ求めよ．</li><li>$s\neq 0$ ならば $S_{1,b,s}$ は無数の素因数を含むことを示せ．</li><li>前問の証明を $s=0$ の場合にも適用するにはどうすればよいか．</li></ol><p class="digression pb-more"><span>余談</span> なお，演習問題(2)は誘導を無視して解くこともできる．<a href="https://ja.wikipedia.org/wiki/%E3%83%95%E3%82%A7%E3%83%AB%E3%83%9E%E3%83%BC%E3%81%AE%E5%B0%8F%E5%AE%9A%E7%90%86">フェルマーの小定理</a>を用いて素数 $p$ で割り切れる項を直接構成する方法が自然であろう．あるいは，<a href="https://ja.wikipedia.org/wiki/%E7%AE%97%E8%A1%93%E7%B4%9A%E6%95%B0%E5%AE%9A%E7%90%86">算術級数定理</a>を認めれば上記の主張は自明である．</p><div class="footer-links"><div><a href="p2.html">前の記事へ</a></div><div><a href="../contents.html#theory">目次に戻る</a></div><div></div></div></div><!--/#main--><div id="sub"><!--PC用（801px以上端末）メニュー--><nav id="menubar"><h2>Menu</h2><ul><li><a href="/SNNN-number-theory/">HOME</a></li><li><a href="/SNNN-number-theory/contents.html">CONTENTS</a></li><li><a href="/SNNN-number-theory/link.html">LINK</a></li></ul></nav><div class="side-profile"><div class="side-profile-header">著者</div><div class="side-profile-container"><div class="side-profile-left"><img src="/SNNN-number-theory/images/kumrnm.jpg" alt="蝙蝠の目"></div><div class="side-profile-right"><div class="side-profile-name">蝙蝠の目</div><div class="side-profile-links"><a href="https://www.nicovideo.jp/user/119196563" target="_blank">niconico</a></div></div></div></div></div><!--/#sub--></div><!--/#contents--></div><!--/#container--><footer><small>Copyright&copy; 2022 蝙蝠の目 All Rights Reserved.</small> <span class="pr"><a href="http://template-party.com/" target="_blank">《Web Design:Template-Party》</a></span></footer><!--小さな端末用（800px以下端末）メニュー--><nav id="menubar-s"><ul><li><a href="/SNNN-number-theory/">HOME</a></li><li><a href="/SNNN-number-theory/contents.html">CONTENTS</a></li><li><a href="/SNNN-number-theory/link.html">LINK</a></li></ul></nav><!--ページの上部に戻る「↑」ボタン--><p class="nav-fix-pos-pagetop"><a href="#">↑</a></p><!--メニュー開閉ボタン--><div id="menubar_hdr" class="close"></div><!--メニューの開閉処理条件設定　800px以下--><script>if (OCwindowWidth() <= 800) {
	open_close("menubar_hdr", "menubar-s");
}</script></body></html>