<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>素因数2の取り扱いについて | SNNN数論</title><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" type="image/x-icon" href="/SNNN-number-theory/favicon.ico"><meta name="description" content="3,37,377,3777,…の性質を探る数学"><meta name="keywords" content="SNNN数,クッキー☆,数学,整数論,数論,数学ッキー☆,SNNN姉貴,理系淫夢"><meta property="og:url" content="https://kumrnm.github.io/SNNN-number-theory/"><meta property="og:title" content="素因数2の取り扱いについて | SNNN数論"><meta property="og:description" content="3,37,377,3777,…の性質を探る数学"><meta property="og:image" content="https://kumrnm.github.io/SNNN-number-theory/images/card.jpg"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="素因数2の取り扱いについて | SNNN数論"><meta name="twitter:description" content="3,37,377,3777,…の性質を探る数学"><meta name="twitter:image" content="https://kumrnm.github.io/SNNN-number-theory/images/card.jpg"><meta name="twitter:creator" content="@kumrnm"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- KaTeX --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous"><script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script><script defer="defer" src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"></script><script src="/SNNN-number-theory/js/common.js"></script><script src="/SNNN-number-theory/js/openclose.js"></script><script src="/SNNN-number-theory/js/fixmenu_pagetop.js"></script><link rel="stylesheet" href="/SNNN-number-theory/css/style.css"></head><body><div id="container"><header><!-- <h1 id="logo"><a href="/index.html"><img src="/images/logo.png" alt="SNNN数論"></a></h1> --><!--スライドショー--><aside id="mainimg"><img src="/SNNN-number-theory/images/banner.jpg" alt="SNNN数論" class="slide0"></aside><a id="titleLink" href="/SNNN-number-theory/"></a></header><div id="contents"><div id="main"><h2>素因数 $2$ の取り扱いについて</h2><p class="date">更新日：2022/9/30</p><p class="pb-more">※ 本記事は位数定理を取り扱う都合上，群論の基礎知識を前提として議論を進める．難解であれば読み飛ばしても差し支えないが，その場合はページ末尾の<a href="#theorem">結論</a>のみ確認されたい．</p><p class="pb-more"><a href="order_theorem.html#theorem">位数定理</a>や<a href="prime_power_2.html#theorem">素数冪の巡回定理</a>は，$p$ が奇素数であるという条件のもとで成立していた．それでは，$p=2$ の場合はどうなるだろうか．実はこのとき，位数定理の証明に用いた群同型 $$ (\Z/p^k\Z)^\times \simeq \Z/p^{k-1}\Z \times \Z/(p-1)\Z $$ が成立しないのである．したがって，位数定理に関連する議論を修正する必要がある．</p><h3 id="order_theorem">$p=2$ の場合の位数定理・素数冪の巡回定理</h3><p class="pb-less">$\ord_{2^k}(a)$ について，$k=1$ の場合は明らかに $\ord_2(a)=1$ であるから，以下では $k\ge 2$ の場合を考える．$(\Z/2^k\Z)^\times$ において，$x\in(\Z/2^k\Z)^\times$ が生成する部分群を $\lang x\rang$ と表記する．$k\ge 2$ であるとき，$(\Z/2^k\Z)^\times$ の群構造は $$ \begin{align*} (\Z/2^k\Z)^\times &\simeq \lang -1 \rang \times \lang 5 \rang \\ &\simeq \Z/2\Z \times \Z/2^{k-2}\Z \\ \end{align*} $$ となることが知られている（証明は<a href="https://integers.hatenablog.com/entry/2016/07/24/163831">こちら</a>）．よって，十分大きな整数 $K$ に対し，$2$ と互いに素な整数 $a$ が $a\equiv (-1)^{a''} \cdot 5^{a'} \mod{2^K}$ と表示されるとき，$1\le k\le K$ の範囲で $$ \begin{equation} \ord_{2^k}(a) = \lcm( \ord_{\Z/2\Z}(a''), \ord_{\Z/2^{k-2}\Z}(a') ) \end{equation} $$ が成り立つ．この式に $k=2$ を代入すると $$ \begin{align*} \ord_{2^2}(a) &= \lcm( \ord_{\Z/2\Z}(a''), \ord_{\Z/\Z}(a') ) \\ &= \lcm( \ord_{\Z/2\Z}(a''), 1 ) \\ &= \ord_{\Z/2\Z}(a'') \\ \end{align*} $$ を得る．さらに，$\ord_{\Z/2\Z}(a'')\in\{1,2\}$ より $\ord_{2^2}(a)\in\{1,2\}$ であるから $$ \begin{equation} \begin{split} \ord_{\Z/2\Z}(a'') &= \ord_{2^2}(a) \\ &= 2^{\ord_{2^2}(a)-1} \\ \end{split} \end{equation} $$ が成り立つ．一方，$\ord_{\Z/2^{k-2}\Z}(a')$ については，$p$ が奇素数の場合と同様の<a href="order_theorem.html#lemma">補題</a>を用いて $$ \begin{align} \ord_{\Z/2^{k-2}\Z}(a') = 2^{\max(0,k-2-\nu_2(a'))} \end{align} $$ と表される．(2),(3)式を(1)式に代入すると $$ \begin{equation} \begin{split} \ord_{2^k}(a) &= \lcm( 2^{\ord_{2^2}(a)-1}, 2^{\max(0,k-2-\nu_2(a'))} ) \\ &= 2^{\max(\ord_{2^2}(a)-1, 0, k-2-\nu_2(a'))} \\ &= 2^{\max(\ord_{2^2}(a)-1, k-2-\nu_2(a'))} \\ \end{split} \end{equation} $$ を得る．この式と $\ord_{2^2}(a)=2^{\ord_{2^2}(a)-1}$ より $$ \begin{equation} \begin{split} \ord_{2^k}(a) = \ord_{2^2}(a) &\iff 2^{\max(\ord_{2^2}(a)-1, k-2-\nu_2(a'))} = 2^{\ord_{2^2}(a)-1} \\ &\iff \ord_{2^2}(a)-1 \ge k-2-\nu_2(a') \\ &\iff k \le 1+\nu_2(a')+\ord_{2^2}(a) \end{split} \end{equation} $$ が成り立つ．一方，位数の定義より $$ \begin{equation} \begin{split} \ord_{2^k}(a) = \ord_{2^2}(a) &\iff a^{\ord_{2^2}(a)}\equiv 1\mod{2^k} \\ &\iff \nu_2(a^{\ord_{2^2}(a)}-1) \ge k \\ \end{split} \end{equation} $$ であるから，(5),(6)式を比較して $$ \begin{align*} 1+\nu_2(a')+\ord_{2^2}(a) &= \nu_2(a^{\ord_{2^2}(a)}-1) \\ \nu_2(a') &= \nu_2(a^{\ord_{2^2}(a)}-1) - \ord_{2^2}(a) - 1 \\ \end{align*} $$ となり，これを(4)式に代入して $$ \begin{align} \ord_{2^k}(a) = 2^{\max( \ord_{2^2}(a)-1, k-1-\nu_2(a^{\ord_{2^2}(a)}-1)+\ord_{2^2}(a) )} \end{align} $$ を得る．ここで，$a$ を $4$ で割った余りに応じて場合分けを行う．</p><h4>$a\equiv 1\mod{4}$ の場合</h4><p class="pb-less">(7)式に $\ord_{2^2}(a)=\ord_4(1)=1$ を代入して $$ \ord_{2^k}(a)=2^{\max(1-1,k-1-\nu_2(a^1-1)+1)}=2^{\max(0,k-\nu_2(a-1))} $$ となる．</p><h4>$a\equiv 3\mod{4}$ の場合</h4><p class="pb-more">(7)式に $\ord_{2^2}(a)=\ord_4(3)=2$ を代入して $$ \ord_{2^k}(a)=2^{\max(2-1,k-1-\nu_2(a^2-1)+2)}=2^{\max(1,k+1-\nu_2(a^2-1))} $$ となる．さらに $$ \nu_2(a^2-1)=\nu_2(a-1)+\nu_2(a+1)=1+\nu_2(a+1) $$ を代入して $$ \ord_{2^k}(a)=2^{\max(1,k-\nu_2(a+1))} $$ を得る．</p><p>以上の結果を定理として以下に記す．</p><p class="theorem" id="theorem_order"><span>位数定理 $(p=2)$</span> 正整数 $k$ と奇数 $a$ に対し， $$ \ord_{2^k}(a)=\begin{cases} 1 & \text{if }k=1 \\ 2^{\max(0,k-\nu_2(a-1))} & \text{if }k>1\text{ and }a\equiv 1\mod{4} \\ 2^{\max(1,k-\nu_2(a+1))} & \text{if }k>1\text{ and }a\equiv 3\mod{4}. \end{cases} $$</p><p>この結果を用いて，素数冪の巡回定理が導かれる．導出は演習問題とする．</p><p class="theorem" id="theorem"><span>素数冪の巡回定理 $(p=2)$</span> 一般化SNNN数列 $S_{a,b,s}$ が $2\nmid a,\;a\neq 1$ を満たすならば，$S_{a,b,s}$ は任意の自然数 $k$ に対して $2^k$ を法とする基本周期 $u_{2^k}$ を持ち， $$ u_{2^k}=\begin{cases} 1 & \text{if } k\le \nu_2(D)-\nu_2(a-1)+1 \\ 2^{\max(0,k-\~k_2)} \cdot \ord_4(a) & \text{otherwise } \\ \end{cases} $$ が成り立つ．ただし $$ \~k_2 = \begin{cases} \nu_2(D) & \text{if }a\equiv 1\mod{4} \\ \nu_2(D)+\nu_2(a+1) & \text{if }a\equiv 3\mod{4}. \\ \end{cases} $$</p><p>なお，$k\ge\~k_2$ の範囲で $u_{2^{k+1}}=2u_{2^k}$ が成り立つことから，$p$ が奇素数である場合と同様の<a href="prime_power_2.html#corollary">系</a>が成立する．</p><div class="footer-links"><div><a href="prime_power_2.html">前の記事へ</a></div><div><a href="../contents.html#theory">目次に戻る</a></div><div><a href="prime_factors_theorem.html">次の記事へ</a></div></div></div><!--/#main--><div id="sub"><!--PC用（801px以上端末）メニュー--><nav id="menubar"><h2>Menu</h2><ul><li><a href="/SNNN-number-theory/">HOME</a></li><li><a href="/SNNN-number-theory/contents.html">CONTENTS</a></li><li><a href="/SNNN-number-theory/link.html">LINK</a></li></ul></nav><div class="side-profile"><div class="side-profile-header">著者</div><div class="side-profile-container"><div class="side-profile-left"><img src="/SNNN-number-theory/images/kumrnm.jpg" alt="蝙蝠の目"></div><div class="side-profile-right"><div class="side-profile-name">蝙蝠の目</div><div class="side-profile-links"><a href="https://www.nicovideo.jp/user/119196563" target="_blank">niconico</a> <a href="https://twitter.com/kumrnm" target="_blank">Twitter</a> <a href="https://www.youtube.com/channel/UCz2-YTnMoW5vauT035WBO6A" target="_blank">YouTube</a></div></div></div></div></div><!--/#sub--></div><!--/#contents--></div><!--/#container--><footer><small>Copyright&copy; 2022 <a href="https://twitter.com/kumrnm" target="_blank"><u>蝙蝠の目</u></a> All Rights Reserved.</small> <span class="pr"><a href="http://template-party.com/" target="_blank">《Web Design:Template-Party》</a></span></footer><!--小さな端末用（800px以下端末）メニュー--><nav id="menubar-s"><ul><li><a href="/SNNN-number-theory/">HOME</a></li><li><a href="/SNNN-number-theory/contents.html">CONTENTS</a></li><li><a href="/SNNN-number-theory/link.html">LINK</a></li></ul></nav><!--ページの上部に戻る「↑」ボタン--><p class="nav-fix-pos-pagetop"><a href="#">↑</a></p><!--メニュー開閉ボタン--><div id="menubar_hdr" class="close"></div><!--メニューの開閉処理条件設定　800px以下--><script>if (OCwindowWidth() <= 800) {
	open_close("menubar_hdr", "menubar-s");
}</script></body></html>